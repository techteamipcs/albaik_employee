<div class="container mt--7">
	<div class="row">
		<div class="col-xl-12 order-xl-1">
			<div class="card  shadow">
				<div class="card-header border-0">
					<div class="row align-items-center">
						<div class="col-md-8 col-sm-10 col-12">
							<h3 class="mb-0">Edit Meal</h3>
						</div>
					</div>
				</div>
				<div class="card-body">
					<!-- form start -->
					<form [formGroup]="addmealForm" (ngSubmit)="onSubmit()" method="post" novalidate>
						<div class="form-group">
							<label for="exampleInputEmail1">Meal is Available</label>
							<select name="isAvailable" formControlName="isAvailable" class="form-control">
								<option value="">Select Status</option>
								<option value="true">Active</option>
								<option value="false">Deactive</option>
							</select>
							<span *ngIf="submitted && hasError('isAvailable','required')" class="alert-danger">Please Meal
								Status</span>
						</div>

						<div class="form-group">
							<label for="exampleInputEmail1">Name</label>
							<input type="text" name="name" autocomplete="off" formControlName="name" class="form-control"
								placeholder="Name">
							<span *ngIf="submitted && hasError('name','required')" class="alert-danger">
								Name is required
							</span>
						</div>

						<div class="form-group">
							<label for="exampleInputEmail1">Description</label>
							<!-- <input type="text" name="description" autocomplete="off" formControlName="description" class="form-control"
								placeholder="Description"> -->
							<textarea name="description" autocomplete="off" formControlName="description" class="form-control"
								placeholder="Description"> </textarea>
							<span *ngIf="submitted && hasError('description','required')" class="alert-danger">
								Description is required
							</span>
						</div>

						<div class="form-group">
							<label for="category">Category</label>
							<input type="text" name="category" autocomplete="off" formControlName="category" class="form-control"
								placeholder="Category">
							<span *ngIf="submitted && hasError('category','required')" class="alert-danger">
								Category is required
							</span>
						</div>


						<div class="form-group">
							<label for="requiredEmployees">Required no of Employees</label>
							<input type="number" name="requiredEmployees" autocomplete="off" formControlName="requiredEmployees"
								class="form-control" placeholder="Required no of Employees">
							<span *ngIf="submitted && hasError('requiredEmployees','required')" class="alert-danger">
								Required no of Employees is required
							</span>
						</div>

						<div class="form-group">
							<label for="exampleInputEmail1">Department <span class="required">*</span></label>
							<!-- <select name="departments" formControlName="departments" class="form-control">
								<option value="">Select Department</option>
								<option value="{{item._id}}" *ngFor="let item of departmentData">{{item.name}}</option>
							</select> -->
							<ng-multiselect-dropdown id="select" [placeholder]="'Select Departments'" [settings]="dropdownSettings"
								[data]="departmentList" [formControl]="f.departments">
							</ng-multiselect-dropdown>
							<span *ngIf="submitted && hasError('departments','required')" class="alert-danger">Please Select
								Department</span>
						</div>

						<div class="form-group">
							<label for="exampleInputEmail1">Employee <span class="required">*</span> : </label>
							<div class="col-md-8 col-sm-10 col-12">
								<ng-multiselect-dropdown id="select" [placeholder]="'Select Employee'" [settings]="dropdownSettings"
									[data]="employeeList" [formControl]="f.employees">
								</ng-multiselect-dropdown>
							</div>
						</div>

						<div class="form-group">
							<label for="Ingredients">Ingredients <span class="required">*</span> : </label>
							<div class="col-md-8 col-sm-10 col-12">
								<ng-multiselect-dropdown id="select" [placeholder]="'Select Ingredients'" [settings]="dropdownSettings"
									[data]="ingredientsList" [formControl]="f.ingredients">
								</ng-multiselect-dropdown>
							</div>
						</div>

						<div class="form-group">
							<label for="exampleInputEmail1">Preparation Time</label>
							<input type="number" name="preparationTime" autocomplete="off" formControlName="preparationTime"
								class="form-control" placeholder="Preparation Time">
							<span *ngIf="submitted && hasError('preparationTime','required')" class="alert-danger">
								Preparation Time is required
							</span>
						</div>

						<div class="form-group">
							<label for="machine">Machine</label>
							<input type="text" name="machine" autocomplete="off" formControlName="machine" class="form-control"
								placeholder="No of Machines Required">
							<span *ngIf="submitted && hasError('machine','required')" class="alert-danger">
								no of Machines is required
							</span>
						</div>

						<div class="form-group">
							<label for="package">Package</label>
							<input type="text" name="package" autocomplete="off" formControlName="package" class="form-control"
								placeholder="No of Packaging Box">
							<span *ngIf="submitted && hasError('package','required')" class="alert-danger">
								Package is required
							</span>
						</div>

						<div class="form-group">
							<label for="meal_id">Meal id</label>
							<input type="text" name="meal_id" autocomplete="off" formControlName="meal_id" class="form-control"
								placeholder="Meal Id">
							<span *ngIf="submitted && hasError('meal_id','required')" class="alert-danger">
								Meal Id is required
							</span>
						</div>

						<div class="form-group">
							<label for="price">Price</label>
							<input type="number" name="price" autocomplete="off" formControlName="price" class="form-control"
								placeholder="Price">
							<span *ngIf="submitted && hasError('price','required')" class="alert-danger">
								Price is required
							</span>
						</div>

						<hr class="my-3">
						<div class="form-group">
							<h4 class="text-lg-start">Image/Video <span class="required">*</span></h4>
							<div class="row text-lg-start">
								<div class="col-lg-3 col-md-4 col-6" *ngIf="mediaData">
									<a class="cursor:pointer;text-center">
										<i class="mdi mdi-close-box" aria-hidden="true"></i></a>
									<a class="d-block mb-4 h-100">
										<img src="{{imagePath}}{{mediaData[0].src}}" class="img-fluid img-thumbnail"
											*ngIf="mediaData[0] && mediaData[0].file_type == 'image'" width="200" height="350"
											(click)="editMedia(media,mediaData[0],'media')">
										<video class="img-fluid img-thumbnail" *ngIf="mediaData[0] && mediaData[0].file_type == 'video'"
											width="200" height="350" (click)="editMedia(media,mediaData[0],'media')" controls>
											<source src="{{imagePath}}{{mediaData[0].src}}" type="video/mp4">
										</video>
									</a>
								</div>
								<div class="col-lg-3 col-md-4 col-6">
									<a (click)="openMedia(media)" class="d-block mb-4 h-100">
										<img src="{{url}}/img/addimage.svg" class="img-fluid img-thumbnail" width="150" height="150">
									</a>
								</div>
							</div>
							<label for="exampleInputEmail1" style="display: block;">(Required Size for Image w-1482px *
								h-584px)</label><br>
							<!-- <span *ngIf="submitted && hasError('product_gallery','required')" class="alert-danger">Gallery Images is required</span> -->
						</div>

						<div class="form-group" *ngIf="isEdit">
							<label for="sequence_number">Sequence Number</label>
							<input type="text" name="sequence_number" autocomplete="off" formControlName="sequence_number"
								class="form-control" placeholder="Sequence Number">
							<span *ngIf="submitted && hasError('sequence_number','required')" class="alert-danger">
								Sequence Number is required
							</span>
						</div>

						<h4>Department Details</h4>
						<hr>
						<div class="col-md-12">
							<div class="row">
								<div class="col-md-6">
									<!-- <input class="form-control mt-4 mb-4" type="text" (keyup)="searchProduct()"
											formControlName="searchText" name="searchText" [(ngModel)]="searchText" autocomplete="off"
											placeholder="&#61442;  Start searching a Product by name"> -->
								</div>
								<div class="col-md-6 mt-4 mb-4">
									<button type="button" class="btn btn-button ml-auto" (click)="openModal(modal)">
										Add Dept
									</button>
								</div>
							</div>
						</div>
						<div class="table-responsive">
							<table class="table align-items-center table-flush">
								<thead>
									<tr>
										<th>SL No</th>
										<th>Department</th>
										<th>Position</th>
										<th>EmployeesPerOrder</th>
										<th>Action</th>
									</tr>
								</thead>
								<tbody>
									<td colspan="5" *ngIf="selectedDeptData && selectedDeptData.length == 0">
										<div class="alert alert-dismissable" style="text-align: center;">
											Dept is Empty
										</div>
									</td>
									<tr *ngFor="let cData of selectedDeptData; let i = index">
										<td *ngIf="currentPage == 1">{{i+1}}</td>
										<td *ngIf="currentPage != 1">
											{{i+1+((currentPage - 1) *
											currentLimit)}}</td>
										<td>{{cData.department}}</td>
										<td>{{cData.position}}</td>
										<td>{{cData.employeesPerOrder}}</td>

										<td>
											<a style="cursor:pointer;padding-left: 15px;" (click)="removeDept(i)"><i class="mdi mdi-close-box"
													aria-hidden="true"></i></a>
										</td>
									</tr>
								</tbody>
							</table>
						</div>

						<div class="box-footer d-flex">
							<button type="submit" class="btn btn-button mr-2">Submit</button>
							<button type="cancel" (click)="onCancel()" class="btn btn-button">Cancel</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

<ng-template #modal let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Add Department Need</h4>
		<button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body">
		<!-- Page content -->
		<div class="container">
			<!-- Table -->
			<div class="row">
				<div class="col">
					<div class="card shadow">
						<div class="card-body">
							<div class="table-responsive">
								<form [formGroup]="deptObject" (ngSubmit)="onSubmitDept()" method="post" novalidate>
									<div class="box-body">
										<div class="form-group">
											<label for="exampleInputEmail1">Select Departments</label>
											<select name="department" formControlName="department" class="form-control">
												<option value="">Select Department</option>
												<option [value]="item.name" *ngFor="let item of departmentData">{{item.name}}</option>
											</select>
										</div>

										<div class="form-group">
											<label for="exampleInputEmail1">Select positions</label>
											<select name="position" formControlName="position" class="form-control">
												<option value="">Select position</option>
												<option [value]="item.name" *ngFor="let item of positionData">{{item.name}}</option>
											</select>
										</div>

										<div class="form-group">
											<label for="exampleInputEmail1">employeesPerOrder</label>
											<input type="text" name="employeesPerOrder" autocomplete="off" formControlName="employeesPerOrder"
												class="form-control" placeholder="employeesPerOrder">
											<span *ngIf="submitted && hasError('employeesPerOrder','required')" class="alert-danger">
												EmployeesPerOrder is required</span>
										</div>
									</div>
									<div class="box-footer d-flex">
										<button type="submit" class="btn btn-button mr-2">Submit</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-smallbutton" (click)="modal.close('Close click')">Close</button>
	</div>
</ng-template>

<!-- Image| Model Popup -->
<ng-template #media let-modal style="z-index: 0;">
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Upload Image/Video</h4>
		<button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>
	<div class="modal-body">
		<form [formGroup]="addmediaForm" (ngSubmit)="onSubmitMedia('image')">
			<div class="form-group">
				<label for="exampleInputEmail1">Name <span class="required">*</span></label>
				<input type="text" name="name" autocomplete="off" formControlName="name" class="form-control"
					placeholder="Media Name">
				<span *ngIf="submittedMedia && hasMediaFormError('name','required')" class="alert-danger">File Name is
					required</span>
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">File Type</label>
				<select name="file_type" formControlName="file_type" class="form-control">
					<option value="">Select File Type</option>
					<option value="image">Image</option>
					<option value="video">Video</option>
				</select>
				<span *ngIf="submittedMedia && hasMediaFormError('file_type','required')" class="alert-danger">Please
					Select
					File Type</span>
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">Alt</label>
				<input type="text" name="alt" autocomplete="off" formControlName="alt" class="form-control"
					placeholder="Alt Tag">
				<span *ngIf="submitted && hasMediaFormError('alt','required')" class="alert-danger">Alt is required</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'image'">
				<label for="exampleInputEmail1">Media Image <span class="required">*</span></label><br>
				<input type="file" #uploader ngFileSelect (uploadOutput)="onUploadOutput($event,'image')"
					[uploadInput]="uploadInput" accept="image/*" />
				<img *ngIf="mediaFile" alt="logo" style="height: 100px; width: 100px;margin-top: 5px;"
					src="{{imagePath}}{{mediaFile}}">
				<span *ngIf="submittedMedia && hasMediaFormError('src','required')" class="alert-danger">Please Select
					Image</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'video'">
				<label for="exampleInputEmail1">Media Video <span class="required">*</span></label><br>
				<input type="file" #uploader ngFileSelect (uploadOutput)="onUploadOutput($event,'image')"
					[uploadInput]="uploadInput" accept="video/*" />
				<video width="320" height="240" *ngIf="mediaFile" controls>
					<source src="{{imagePath}}{{mediaFile}}" type="video/mp4">
				</video>
				<span *ngIf="submittedMedia && hasMediaFormError('src','required')" class="alert-danger">Please Select
					Video</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'image'">
				<label for="exampleInputEmail1">Role</label>
				<select name="role" #selectRole formControlName="role" class="form-control"
					(change)="selectImageRole($event,selectRole.value)">
					<option value="">Select Role</option>
					<option value="base">Base</option>
					<option value="small">Small</option>
					<option value="thumbnail">Thumbnail</option>
				</select>
				<span *ngIf="submittedMedia && hasMediaFormError('role','required')" class="alert-danger">Please Select
					Role</span>
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">Height</label>
				<input type="number" name="height" autocomplete="off" formControlName="height" class="form-control"
					placeholder="Height">
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">Width</label>
				<input type="number" name="width" autocomplete="off" formControlName="width" class="form-control"
					placeholder="Width">
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">Sequence Number</label>
				<input type="number" name="sequence_number" autocomplete="off" formControlName="sequence_number"
					class="form-control" placeholder="Sequence Number">
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'video'">
				<label for="exampleInputEmail1">Mute</label>
				<input type="text" name="mute" autocomplete="off" formControlName="mute" class="form-control"
					placeholder="Mute">
				<span *ngIf="submitted && hasMediaFormError('mute','required')" class="alert-danger">Mute is required</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'video'">
				<label for="exampleInputEmail1">Autoplay</label>
				<select name="autoplay" formControlName="autoplay" class="form-control">
					<option value="">Select Autoplay</option>
					<option value="true">Active</option>
					<option value="false">Deactive</option>
				</select>
				<span *ngIf="submitted && hasMediaFormError('autoplay','required')" class="alert-danger">Please Select
					Autoplay</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'video'">
				<label for="exampleInputEmail1">Select Loop</label>
				<select name="loop" formControlName="loop" class="form-control">
					<option value="">Select Loop</option>
					<option value="true">Active</option>
					<option value="false">Deactive</option>
				</select>
				<span *ngIf="submitted && hasMediaFormError('loop','required')" class="alert-danger">Please Select Loop</span>
			</div>
			<div class="form-group" *ngIf="addmediaForm.value.file_type == 'video'">
				<label for="exampleInputEmail1">Full Screen</label>
				<input type="text" name="full_screen" autocomplete="off" formControlName="full_screen" class="form-control"
					placeholder="Full Screen">
				<span *ngIf="submitted && hasMediaFormError('full_screen','required')" class="alert-danger">Full Screen is
					required</span>
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">Select Status</label>
				<select name="status" formControlName="status" class="form-control">
					<option value="">Select Status</option>
					<option value="true">Active</option>
					<option value="false">Deactive</option>
				</select>
				<span *ngIf="submittedMedia && hasMediaFormError('status','required')" class="alert-danger">Please
					Select Status</span>
			</div>
			<div class="box-footer d-flex">
				<button class="btn btn-button mr-2">Submit</button>
				<button type="cancel" (click)="onCancelMedia()" class="btn btn-button">Cancel</button>
			</div>
		</form>
	</div>
	<!-- <div class="modal-footer">
		<button type="button" class="btn btn-smallbutton" (click)="modal.close('Close click')">Close</button>
	</div> -->
</ng-template>
